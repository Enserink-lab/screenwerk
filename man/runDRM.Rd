% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runDRM.R
\name{runDRM}
\alias{runDRM}
\title{Run dose-response model}
\usage{
runDRM(processedData, .saveto, .plot)
}
\arguments{
\item{processedData}{an object of class 'processedData'.}

\item{.saveto}{string; path to a folder location where the results are saved to.}

\item{.plot}{logical; if TRUE, then fitted dose-response will be plotted. The default is FALSE, in which no plots will be generated.}
}
\value{
Returns an object of type list with the dose-response model, a summary and the estimated ECs.
}
\description{
An essential component of the modular library \pkg{screenwerk}, and imperative for the analysis of the experimental data from a drug sensitivity screen.
\emph{\code{runDRM}} is a function that runs the dose-response model for the analysis of single drug treatments. It performs curve fitting using a \emph{four-parameter log-logistic function (LL.4)}, 
and estimates the EC10, EC50 and EC90. The function also plots the single drug curves by viability and inhibition for each single drug.

The dose-response analysis is performed with the function \code{\link[drc]{drm}} from the R-package \emph{drc} as described in the
original paper by Ritz, 2015, PLOS ONE (see references).
}
\details{
The function \code{runDRM} is used to run the first of a series of analyses, specifically, it looks at the dose response of each single drug. 
It performs curve fitting based on a four-parameter log-logistic model and estimates the EC50s, along with the EC10 and EC90. The curve fitting is performed with lower limits set to 0 and 
the upper limit to 1. In cases where the curve fitting fails, such as due to lack of response resulting in a flat line, or due to outliers, or any other irregularities, the fitting is performed without restrictions to either one of the limits.

All estimates of the EC50s is exported as a table in a csv file format. Plots are exported as composite of all drugs for each sample as individual png image files.

Files are saved either to the specified location or the default working environment, with the corresponding folder structure: 'results/EC50s' and 'results/graphs/single drug response'
}
\examples{
\donttest{\dontrun{
# Process consolidated data
runDRM(processedData, .saveto = "path/to/folder/")
}}

}
\references{
Ritz, C., Baty, F., Streibig, J. C., Gerhard, D. (2015) Dose-Response Analysis Using R. PLOS ONE 10 (12), e0146021. DOI: 10.1371/journal.pone.0146021
}
\seealso{
\code{\link[drc]{drm}}
}
\keyword{analysis}
\keyword{curve}
\keyword{drc}
\keyword{drm}
\keyword{drug}
\keyword{fitting}
\keyword{log}
\keyword{logistic}
\keyword{screen}
\keyword{single}
