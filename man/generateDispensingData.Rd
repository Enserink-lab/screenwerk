% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generateDispensingData.R
\name{generateDispensingData}
\alias{generateDispensingData}
\title{Generate a dispensing data set}
\usage{
generateDispensingData(
  listofCombinations,
  listofDrugs,
  listofDoses,
  listofVolumes,
  listofCtrls,
  listofStockConcentrations,
  sourcePlate,
  listofExWells,
  .ctrlReplicates,
  .addUntreated = FALSE,
  .finalWellVolume,
  .plateFormat,
  .destinationPlateID,
  .randomizeDispensing = TRUE,
  .probeDispensing = FALSE
)
}
\arguments{
\item{listofCombinations}{\code{data frame}; a list of drug treatments in long-format. The data frame needs to include a column with the drug name, dose and unit for each drug. For help generating a list of combinations, see \emph{combineDrugs}.}

\item{listofDrugs}{\code{data frame}; a list of drugs with a unique drug id, name and CAS number.}

\item{listofDoses}{\code{data frame}; a list of drugs and doses in long-format with essential columns that include the drug names, all doses and the units. For help generating a list of doses, see \emph{generateListofDoses}.}

\item{listofVolumes}{\code{data frame}; a list of volumes for each drug and dose in wide- or long-format with essential columns that include the drug names, the dispensing volume for each dose and the units.}

\item{listofCtrls}{\code{data frame}; a list of controls to include in the screen. The data frame needs to include a column with the name, dose, unit, dispensing volume and the CAS number for each of the controls.}

\item{listofStockConcentrations}{\code{data frame}; a list of stock concentrations for each of the drugs with essential columns that include a unique drug id, drug name, the stock concentration of the drugs and the unit.}

\item{sourcePlate}{\code{data frame}; the source plate with the drugs and doses to dispense from. The data frame needs to include a column with a unique plate id, the well, the drug name, drug concentration and unit. For help importing a source plate from a .PlateMap file, see \emph{importPlateMap}.}

\item{listofExWells}{\code{vector}; a list of wells to excluded from dispensing to. For help generating a list of excluded wells, see \emph{excludeWells}.}

\item{.ctrlReplicates}{\code{numeric}; a value providing the number of replicates for each of the controls.}

\item{.addUntreated}{\code{list}; a list containing the name and the number of replicates for the untreated control. The list needs to contain the named elements \emph{name} and \emph{replicates}, respectively. If no untreated controls are to be used, the argument can be left out or explicitly set to FALSE.}

\item{.finalWellVolume}{\code{numeric}; a value providing the final volume across all wells found on the destination (treatment) plate.}

\item{.plateFormat}{\code{integer}; a predefined numeric value designating the plate format based on either 6, 12, 24, 48, 96, 384 or 1536 wells.}

\item{.destinationPlateID}{\code{character}; a unique id for a set of destination (treatment) plates.}

\item{.randomizeDispensing}{\code{logical}; if TRUE, then drug treatments will be randomized across all plates. If FALSE, drug treatments will be dispensed in sequential order. The default is TRUE, in which the drug treatments are randomized.}

\item{.probeDispensing}{\code{logical}; if TRUE, then the dispensing will be probed only and no dispensing data will be generated. The default is FALSE, in which probing is being omitted.}
}
\value{
Returns an object of class S3:dispensingData.
}
\description{
An essential component of the modular library \pkg{screenwerk}, imperative for the initial set-up of a drug sensitivity screen.
\emph{\code{generateDispensingData}} is a function that generates a dispensing data set from a list of drug treatments. 
It allows to probe a hypothetical dispensing prior to generating a dispensing data set or any dispensing files, providing a summary with essential information about the potential dispensing.
}
\details{
The function \code{generateDispensingData} is used to accomplish at least two fundamental objectives: (a) to generate dispensing files, which are used to dispense a list of drugs from a \strong{source plate} onto a \strong{destination plate}, and/or (b) to map the dispensing to the readout of a drug screen.

The dispensing data basically contains instructions from where to pick individual drugs and where to dispense them to. In most drug sensitivity screens, drugs are dispensed from a \emph{source plate} onto a \emph{destination plate}. The \emph{destination plate} is the plate, in which an assay, and hence the actual experiment, is conducted.
At the final stage of the experiment, the assay will be terminated and the drug treatments evaluated. To map the readout of the assay to the actual drug treatments, the dispensing data is needed.
In order to successfully generate a dispensing set, the provision of a number of lists is required. Those lists are essential for building a complete dispensing data set.

A list of treatments, such as the \emph{listofCombinations} for a drug combination screen, contains a number of drug combinations, which have been previously generated from a list of drugs and doses. The list of combinations can be generated using another function in this package, \code{\link{combineDrugs}}.

Furthermore, a number of additional list are needed. The \emph{listofDrugs} and the \emph{listofCtrls} serve as a reference list, both containing unique identifiers (id, and cas numbers) for each of the drugs used in the drug screen.
The \emph{listofDoses} provides the doses at which each drug is being dispensed. This list is a precursor of the \emph{listofCombinations}. In most cases, data is only available in a human readable format, which often is provided in a long-format.
In order to increase efficiency, the data is converted into a machine friendly, long-format. The function \emph{transformListofDoses} found in this package was build with this purpose in mind and is used to convert a list of \emph{listofDoses} from wide- to long-format.

The same is being done with the \emph{listofVolumes}. A list that can be provided in a wide-format, in which the function will convert it to a long-format.

The \emph{listofStockConcentrations} contains another reference list with the stock concentrations of all drugs provided. Please note, that for all reference lists, a set of unique identifiers is required. All drugs must have an unique id and should have a unique CAS number.

The \emph{sourcePlate} is another essential component, in order to be able to generate a dispensing set. It serves as a map to the \emph{source plate} from which individual drugs are picked and dispensed onto the \emph{destination plate}. The source plate contains therefore a list of wells with drugs at different concentrations. 
Please note: as of current, the doses of drugs on the destination plate can only be mapped to the concentrations of drugs on the source plate though the volumes provided. The well on the source plate, containing the corresponding drug concentration for dispensing, is identified through: \code{((final volume / transfer volume) * drug concentration)}.
In order generate a source plate from a plate map, such as from the proprietary .PlateMap file format, the function \code{\link{importPlateMap}} can be used. Alternatively, a custom plate map can be attached, which however will require the following columns to be present: Well, Drug, Concentration, Unit and PlateID

All wells in the \emph{listofExWells} will be excluded from dispensing into. This list can be conveniently generated using the function \code{excludeWells()} from this package.

The argument \emph{.ctrlReplicates} allows to set the number of replicates for all the controls that have been provided in the \emph{listofCtrls}. If an untreated control is needed, this can be done through the argument \emph{.addUntreated}, which has to be a list containing the name and the number of replictes for the untreated control, i.e. \code{.addUntreated = list(name = "Untreated", replicates = 8)}

The argument \emph{.finalWellVolume} provides the final and total volume in all wells on the \emph{destination plate} that has been dispensed into. This argument is important in mapping the stock concentration on the \emph{source plate} to the final drug concetration to the \emph{destination plate}.

The argument \emph{.plateFormat} defines the format of the \emph{destination plate}, in which the assay is performed. This value is representative of the number of wells found on the microplate.

The argument \emph{.destinationPlateID} allows to provide a unique dispensing, or experimental, identifier from which a unique \emph{destination plate} barcode is being generated for each plate and set.

The argument \emph{.randomizeDispensing} offers the possibility to randomize drug treatments across all plates of a dispensing set. Randomization offers the benefit of reducing spatial variance by randomizing the noise across a larger sample size. If drug treatments are dispensed in sequential order, the technical noise as a result of the experimental variation will impact the entire dose range of a drug treatment. 
This can cause the result to be skewed and potentially result in a false positive or negative interpretation of the response. Hence, due to the critical importance of randomization for quality assurance, the default is set to TRUE. If the argument is set to FASLE, the drug treatments will be dispensed in sequential order as found in the \emph{listofCombinations}.


An important feature of this function is the possibility to probe a dispensing based on the data provided prior to generating a dispensing file. This can be crucial, if there are limitation in place in form of equipment, material, time or any other resources, in which only a limited number of drug treatments, plates or sets can be experimentally carried out.
This argument will generate a short summary and allow the user to estimate the number of drugs, controls, and plates among other things required for a given experimental set-up and make necessary changes, if the limitations require it. In order to probe a dispensing, only a limited number of essential data is required, which are 
\emph{listofCombinations}, \emph{listofCtrls}, \emph{listofExWells}, \emph{.ctrlReplicates}, \emph{.addUntreated}, and \emph{.plateFormat}


The function \code{generateDispensingData} generate an object of class S3, which can be used to extract the dispensing data set with the function \code{\link{print}}, to generate a dispensing summary with \code{\link{summary}}, plot the dispensing data for each plate with \code{\link{plot}} or save each dispensing set to file with \code{\link{save}}.
}
\note{
Version: 2021.03
}
\examples{
\donttest{\dontrun{
library(screenwerk)

# Generate a dispensing data set
generateDispensingData(listofCombinations, listofDrugs, listofDoses, listofVolumes, listofCtrls, 
listofStockConcentrations, sourcePlate, listofExWells, .ctrlReplicates = 8, 
.addUntreated = list(name = "Untreated", replicates = 8), .finalWellVolume = 5, 
.plateFormat = 1536, .destinationPlateID = "0521", .randomizeDispensing = TRUE, 
.probeDispensing = FALSE)

# Probe a potential dispensing for summary statistics
generateDispensingData(listofCombinations, listofCtrls, listofExWells, .ctrlReplicates = 8, 
.addUntreated = list(name = "Untreated", replicates = 8), .plateFormat = 1536, 
.probeDispensing = TRUE)
}}

}
\references{
Robert Hanes et al.
}
\author{
Robert Hanes
}
\keyword{combination}
\keyword{dispensing}
\keyword{drug}
\keyword{screen}
